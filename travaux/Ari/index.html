<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Subjective tag array</title>
		<style>
			@font-face {
				font-family: 'Today';
				src: url("TodaySHOP-Medium.otf");
			}
			
			div {
				text-align: center;
			}
			
			div > svg > g > text {
				text-transform: uppercase;
				font-family: 'Today', sans-serif;
				cursor: pointer;
			}
		</style>
		<script src="d3.min.js" type="text/javascript"></script>
		<script type="text/javascript">
			var dt;
			var svg;
			var texts;
			var colors = ["#14518c", "#30bc97", "#fda805", "#ea0020"];
			var colorRange;
			function init () {
				d3.csv("100notions.csv", function (rows) {
					dt = rows;
					dt.forEach (function (d) {
						d.poids = 1;
					});
					svg = d3.select ("#viz")
						.append ("svg").attr('height', '2500').attr ('width', '600')
						.append("g");
					update ();
				});
			}
			
			function update () {
				var tri = dt.sort(function (a, b) {
					if (a.poids == b.poids) {
						return 0;
					}
					else {
						return a.poids > b.poids ? -1 : 1;
					}
				});
				var poidsMax = 1;
				for (var i = 0; i < tri.length; i++) {
					if (tri[i].poids > poidsMax) {
						poidsMax = tri[i].poids;
					}
				}
				texts = svg.selectAll ("text").data (tri);
				texts.enter ().append ("text");
				texts.text (function (d) {
					return d.NOTIONS;
				});
				colorRange = d3.scale.linear ().domain (d3.range (0, 1, 1.0 / (colors.length))).range (colors);
				var colorize = d3.scale.linear ().domain ([1, poidsMax]).range ([0,1]);
				texts.style ('fill', function (d) {
					return colorRange (colorize (d.poids));
				})
				.attr ('y', function (d, i) {
						return i * 18 + 18;
					})
				.on ('click', function (d) {
						d.poids++;
						update ();
					})
				texts.exit().remove();
			}
		</script>
	</head>
	<body onload="init()">
		<div id="viz"></div>
	</body>
</html>